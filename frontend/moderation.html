<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–¥–µ—Ä–∞—Ü–∏—è - Car Marketplace</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üöó</text></svg>">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js@10.2.0/public/assets/styles/choices.min.css">
</head>
<body>
    <header>
        <div class="header-container">
            <div class="logo">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <h1>üöó Car Marketplace</h1>
                </a>
            </div>
            <nav class="navbar">
                <button id="themeToggle" class="theme-toggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"></button>
                <div id="userMenu" class="user-menu">
                    <span id="userName"></span>
                    <div class="dropdown">
                        <a href="profile.html">–ü—Ä–æ—Ñ–∏–ª—å</a>
                        <a href="moderation.html" class="active">–ú–æ–¥–µ—Ä–∞—Ü–∏—è</a>
                        <a href="reports.html" style="display: none;">–ñ–∞–ª–æ–±—ã</a>
                        <a href="#" id="myListingsLink">–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</a>
                        <a href="#" id="favoritesLink">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
                        <a href="#" id="messagesLink">–°–æ–æ–±—â–µ–Ω–∏—è</a>
                        <a href="#" id="logoutLink">–í—ã—Ö–æ–¥</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="moderation-container">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ -->
                <section class="moderation-stats-section">
                    <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h2>
                    <div class="stats-grid">
                        <div class="stat-card pending">
                            <div class="stat-value" id="pendingCount">0</div>
                            <div class="stat-label">–û–∂–∏–¥–∞—é—Ç –º–æ–¥–µ—Ä–∞—Ü–∏–∏</div>
                        </div>
                        <div class="stat-card approved">
                            <div class="stat-value" id="approvedCount">0</div>
                            <div class="stat-label">–û–¥–æ–±—Ä–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</div>
                        </div>
                        <div class="stat-card rejected">
                            <div class="stat-value" id="rejectedCount">0</div>
                            <div class="stat-label">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</div>
                        </div>
                    </div>
                </section>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞) -->
                <section id="moderatorsManagementSection" class="moderators-management-section" style="display: none;">
                    <div class="section-header">
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º–∏</h2>
                        <button id="refreshUsersBtn" class="btn btn-secondary">–û–±–Ω–æ–≤–∏—Ç—å</button>
                    </div>

                    <!-- –§–∏–ª—å—Ç—Ä—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                    <div class="moderation-filters">
                        <input type="text" id="userSearchInput" class="filter-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, email...">
                        <select id="userRoleFilter" class="filter-select">
                            <option value="">–í—Å–µ —Ä–æ–ª–∏</option>
                            <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                            <option value="moderator">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
                            <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                        </select>
                        <button id="searchUsersBtn" class="btn btn-primary">–ü–æ–∏—Å–∫</button>
                    </div>

                    <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                    <div id="usersContainer" class="users-table-container">
                        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</div>
                    </div>

                    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                    <div id="usersPagination" class="pagination" style="display: none;">
                        <button id="usersPrevPage" class="btn btn-outline">–ù–∞–∑–∞–¥</button>
                        <span id="usersPageInfo" class="page-info"></span>
                        <button id="usersNextPage" class="btn btn-outline">–í–ø–µ—Ä–µ–¥</button>
                    </div>
                </section>

                <!-- –°–ø–∏—Å–æ–∫ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π -->
                <section class="moderation-listings-section">
                    <div class="section-header">
                        <h2>–û–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h2>
                        <div class="moderation-actions">
                            <button id="refreshBtn" class="btn btn-secondary">–û–±–Ω–æ–≤–∏—Ç—å</button>
                            <button id="batchApproveBtn" class="btn btn-primary" style="display: none;">–û–¥–æ–±—Ä–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</button>
                        </div>
                    </div>

                    <!-- –§–∏–ª—å—Ç—Ä—ã -->
                    <div class="moderation-filters">
                        <select id="sortFilter" class="filter-select">
                            <option value="createdAt">–ü–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è</option>
                            <option value="updatedAt">–ü–æ –¥–∞—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</option>
                        </select>
                        <select id="orderFilter" class="filter-select">
                            <option value="ASC">–°—Ç–∞—Ä—ã–µ —Å–Ω–∞—á–∞–ª–∞</option>
                            <option value="DESC">–ù–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞</option>
                        </select>
                    </div>

                    <!-- –¢–∞–±–ª–∏—Ü–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π -->
                    <div id="moderationListingsContainer" class="moderation-listings-table">
                        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π...</div>
                    </div>

                    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                    <div id="moderationPagination" class="pagination" style="display: none;">
                        <button id="moderationPrevPage" class="btn btn-outline">–ù–∞–∑–∞–¥</button>
                        <span id="moderationPageInfo" class="page-info"></span>
                        <button id="moderationNextPage" class="btn btn-outline">–í–ø–µ—Ä–µ–¥</button>
                    </div>
                </section>

                <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
                <div id="moderationModal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 id="modalTitle">–ü—Ä–æ—Å–º–æ—Ç—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
                            <button class="modal-close" id="closeModalBtn">&times;</button>
                        </div>
                        <div class="modal-body" id="modalBody">
                            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
                        </div>
                        <div class="modal-footer">
                            <button id="modalRejectBtn" class="btn btn-secondary">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                            <button id="modalApproveBtn" class="btn btn-primary">–û–¥–æ–±—Ä–∏—Ç—å</button>
                        </div>
                    </div>
                </div>

                <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è -->
                <div id="rejectModal" class="modal" style="display: none;">
                    <div class="modal-content modal-small">
                        <div class="modal-header">
                            <h2>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
                            <button class="modal-close" id="closeRejectModalBtn">&times;</button>
                        </div>
                        <div class="modal-body">
                            <form id="rejectForm">
                                <div class="form-group">
                                    <label for="rejectReason">–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è *</label>
                                    <textarea id="rejectReason" name="rejectReason" class="form-input" rows="4" required placeholder="–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è"></textarea>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" id="cancelRejectBtn" class="btn btn-outline">–û—Ç–º–µ–Ω–∞</button>
                                    <button type="submit" class="btn btn-secondary">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-container">
            <p>&copy; 2025 Car Marketplace. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            <div class="footer-links">
                <a href="about.html">–û –Ω–∞—Å</a>
                <a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
                <a href="rules.html">–ü—Ä–∞–≤–∏–ª–∞</a>
            </div>
        </div>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
    <div id="createListingModal" class="modal" style="display: none;">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>–î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h2>
                <button class="modal-close" onclick="closeCreateListingModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createListingForm" class="profile-form">
                    <div id="createListingErrorMessage" class="error-message" style="display: none;"></div>
                    <div id="createListingSuccessMessage" class="success-message" style="display: none;"></div>

                    <h3 style="margin-bottom: 1rem; color: #2c3e50;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ–º–æ–±–∏–ª–µ</h3>
                    
                    <div class="form-group">
                        <label for="createVin">VIN –Ω–æ–º–µ—Ä</label>
                        <div style="display: flex; gap: 0.5rem; align-items: flex-end;">
                            <div style="flex: 1;">
                                <input type="text" id="createVin" name="vin" class="form-input" placeholder="VIN –Ω–æ–º–µ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª—è" maxlength="17" style="text-transform: uppercase;">
                            </div>
                            <button type="button" id="fillByVinBtn" class="btn btn-outline" style="white-space: nowrap; padding: 0.75rem 1rem;">
                                –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ VIN
                            </button>
                        </div>
                        <small class="form-hint" style="display: block; margin-top: 0.5rem; color: var(--text-secondary, #546e7a);">
                            –í–≤–µ–¥–∏—Ç–µ VIN –Ω–æ–º–µ—Ä –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label for="createMake">–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è *</label>
                        <select id="createMake" name="make" class="form-input choices-select" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫—É</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="createModel">–ú–æ–¥–µ–ª—å *</label>
                        <select id="createModel" name="model" class="form-input choices-select" required disabled>
                            <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫—É</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="createYear">–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞ *</label>
                        <select id="createYear" name="year" class="form-input choices-select" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="createMileage">–ü—Ä–æ–±–µ–≥ (–∫–º)</label>
                        <input type="number" id="createMileage" name="mileage" class="form-input" min="0" placeholder="50000">
                    </div>

                    <div class="form-group">
                        <label for="createBodyType">–¢–∏–ø –∫—É–∑–æ–≤–∞</label>
                        <select id="createBodyType" name="bodyType" class="form-input">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫—É–∑–æ–≤–∞</option>
                            <option value="Sedan">–°–µ–¥–∞–Ω</option>
                            <option value="Hatchback">–•—ç—Ç—á–±–µ–∫</option>
                            <option value="SUV">–í–Ω–µ–¥–æ—Ä–æ–∂–Ω–∏–∫</option>
                            <option value="Coupe">–ö—É–ø–µ</option>
                            <option value="Wagon">–£–Ω–∏–≤–µ—Ä—Å–∞–ª</option>
                            <option value="Convertible">–ö–∞–±—Ä–∏–æ–ª–µ—Ç</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="createEngineType">–¢–∏–ø –¥–≤–∏–≥–∞—Ç–µ–ª—è</label>
                        <select id="createEngineType" name="engineType" class="form-input">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–≤–∏–≥–∞—Ç–µ–ª—è</option>
                            <option value="Gasoline">–ë–µ–Ω–∑–∏–Ω</option>
                            <option value="Diesel">–î–∏–∑–µ–ª—å</option>
                            <option value="Hybrid">–ì–∏–±—Ä–∏–¥</option>
                            <option value="Electric">–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="createTransmission">–ö–æ—Ä–æ–±–∫–∞ –ø–µ—Ä–µ–¥–∞—á</label>
                        <select id="createTransmission" name="transmission" class="form-input">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ö–ü–ü</option>
                            <option value="Manual">–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è</option>
                            <option value="Automatic">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è</option>
                            <option value="CVT">–í–∞—Ä–∏–∞—Ç–æ—Ä</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="createColor">–¶–≤–µ—Ç</label>
                        <select id="createColor" name="color" class="form-input choices-select">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç</option>
                        </select>
                    </div>

                    <h3 style="margin: 2rem 0 1rem 0; color: #2c3e50;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±—ä—è–≤–ª–µ–Ω–∏–∏</h3>

                    <div class="form-group">
                        <label for="createTitle">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—è *</label>
                        <input type="text" id="createTitle" name="title" class="form-input" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Toyota Camry 2020, –æ—Ç–ª–∏—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ">
                    </div>

                    <div class="form-group">
                        <label for="createPrice">–¶–µ–Ω–∞ *</label>
                        <input type="number" id="createPrice" name="price" class="form-input" required min="0" step="0.01" placeholder="15000">
                    </div>

                    <div class="form-group">
                        <label for="createCurrency">–í–∞–ª—é—Ç–∞</label>
                        <select id="createCurrency" name="currency" class="form-input">
                            <option value="EUR">EUR (–ï–≤—Ä–æ)</option>
                            <option value="USD">USD (–î–æ–ª–ª–∞—Ä)</option>
                            <option value="UAH">UAH (–ì—Ä–∏–≤–Ω–∞)</option>
                            <option value="RUB">RUB (–†—É–±–ª—å)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="createDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="createDescription" name="description" class="form-input" rows="4" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="createRegion">–û–±–ª–∞—Å—Ç—å</label>
                        <select id="createRegion" name="region" class="form-input choices-select">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="createCity">–ì–æ—Ä–æ–¥</label>
                        <select id="createCity" name="city" class="form-input choices-select" disabled>
                            <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="createImages">–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è (–¥–æ 8 —à—Ç.)</label>
                        <input type="file" id="createImages" name="images" class="form-input" accept="image/jpeg,image/png,image/webp,image/gif" multiple>
                        <small class="form-hint">–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 8 –ú–ë</small>
                        <div id="imagePreview" class="image-preview-container" style="display: none; margin-top: 1rem;"></div>
                    </div>

                    <div class="form-group" style="margin-top: 1.5rem;">
                        <button type="submit" class="btn btn-primary btn-block">–°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</button>
                        <button type="button" class="btn btn-outline btn-block" onclick="closeCreateListingModal()" style="margin-top: 0.5rem;">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/theme.js"></script>
    <script>
        // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ Choices.js –∑–∞–≥—Ä—É–∂–µ–Ω –ø–µ—Ä–µ–¥ –º–æ–¥—É–ª—è–º–∏
        if (!window.choicesLoaded) {
            window.choicesLoaded = false;
            const choicesScript = document.createElement('script');
            choicesScript.src = 'https://cdn.jsdelivr.net/npm/choices.js@10.2.0/public/assets/scripts/choices.min.js';
            choicesScript.onload = function() {
                window.choicesLoaded = true;
                if (typeof Choices !== 'undefined') {
                    window.Choices = Choices;
                }
            };
            document.head.appendChild(choicesScript);
        }
    </script>
    <script src="js/moderation.js"></script>
    <script type="module" src="js/createListing.js?v=3"></script>
</body>
</html>

